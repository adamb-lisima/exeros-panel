<ng-container *ngIf="events">
  <app-infinity-scroll *ngIf="eventsMeta" [transparent]="true" [listGap]="true" [pageMeta]="eventsMeta" [loading]="eventsLoading ?? false">
    <ng-container list>
      <div *ngFor="let event of events; trackBy: trackByField('id')" class="flex justify-between items-center px-3 py-2.5 rounded-lg cursor-pointer border border-bright-gray hover:border-main-primary hover:shadow-sm transition-all duration-200 bg-white" (click)="handleEventClick(event)" (keydown.enter)="handleEventClick(event)">
        <div class="flex items-center gap-3 flex-1 min-w-0">
          <app-event-icon [eventIcon]="event.event_icon" class="flex-shrink-0"></app-event-icon>
          <div class="flex flex-col min-w-0 flex-1">
            <p class="text-sm font-semibold text-gray-900">{{ event.display_name }}</p>
            <p class="text-xs text-gray-500">{{ event.occurence_time | dateFormat : 'serverDateTimeFormat' : 'clientDateTimeFormat' }}</p>
          </div>
        </div>
        <div *ngIf="event.star_rating" class="flex items-center gap-3 flex-shrink-0">
          <div class="items-center flex gap-1">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <mask id="mask0_3258_20271" style="mask-type: alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="14" height="14">
                <rect width="14" height="14" fill="#D9D9D9" />
              </mask>
              <g mask="url(#mask0_3258_20271)">
                <path d="M7.00016 8.32042L8.03558 8.95202C8.13134 9.01259 8.22798 9.00919 8.3255 8.94181C8.42311 8.87453 8.45923 8.78329 8.43385 8.66808L8.15895 7.48348L9.08339 6.68475C9.17313 6.60473 9.19948 6.51053 9.16243 6.40212C9.12539 6.29372 9.0463 6.23466 8.92516 6.22494L7.71693 6.12285L7.2402 5.01117C7.19538 4.90568 7.11537 4.85294 7.00016 4.85294C6.88495 4.85294 6.80494 4.90568 6.76012 5.01117L6.28339 6.12285L5.07516 6.22494C4.95402 6.23466 4.87493 6.29372 4.83789 6.40212C4.80085 6.51053 4.8272 6.60473 4.91693 6.68475L5.84137 7.48348L5.56648 8.66808C5.5411 8.78329 5.57722 8.87453 5.67483 8.94181C5.77234 9.00919 5.86898 9.01259 5.96475 8.95202L7.00016 8.32042ZM5.16937 11.375H3.67968C3.38879 11.375 3.14029 11.272 2.93418 11.066C2.72817 10.8599 2.62516 10.6114 2.62516 10.3205V8.83083L1.54148 7.7381C1.44202 7.63271 1.36686 7.5161 1.31602 7.38825C1.26517 7.2603 1.23975 7.1309 1.23975 7.00004C1.23975 6.86918 1.26517 6.73978 1.31602 6.61183C1.36686 6.48398 1.44202 6.36737 1.54148 6.26198L2.62516 5.16925V3.67956C2.62516 3.38867 2.72817 3.14017 2.93418 2.93406C3.14029 2.72805 3.38879 2.62504 3.67968 2.62504H5.16937L6.2621 1.54135C6.36749 1.44189 6.48411 1.36674 6.61195 1.31589C6.7399 1.26505 6.8693 1.23962 7.00016 1.23962C7.13102 1.23962 7.26043 1.26505 7.38837 1.31589C7.51622 1.36674 7.63284 1.44189 7.73822 1.54135L8.83095 2.62504H10.3206C10.6115 2.62504 10.86 2.72805 11.0661 2.93406C11.2722 3.14017 11.3752 3.38867 11.3752 3.67956V5.16925L12.4588 6.26198C12.5583 6.36737 12.6335 6.48398 12.6843 6.61183C12.7352 6.73978 12.7606 6.86918 12.7606 7.00004C12.7606 7.1309 12.7352 7.2603 12.6843 7.38825C12.6335 7.5161 12.5583 7.63271 12.4588 7.7381L11.3752 8.83083V10.3205C11.3752 10.6114 11.2722 10.8599 11.0661 11.066C10.86 11.272 10.6115 11.375 10.3206 11.375H8.83095L7.73822 12.4587C7.63284 12.5582 7.51622 12.6333 7.38837 12.6842C7.26043 12.735 7.13102 12.7605 7.00016 12.7605C6.8693 12.7605 6.7399 12.735 6.61195 12.6842C6.48411 12.6333 6.36749 12.5582 6.2621 12.4587L5.16937 11.375ZM5.54183 10.5L6.8711 11.8293C6.90474 11.863 6.94776 11.8798 7.00016 11.8798C7.05257 11.8798 7.09559 11.863 7.12923 11.8293L8.4585 10.5H10.3206C10.373 10.5 10.4161 10.4832 10.4497 10.4496C10.4833 10.4159 10.5002 10.3729 10.5002 10.3205V8.45837L11.8294 7.1291C11.8631 7.09546 11.8799 7.05244 11.8799 7.00004C11.8799 6.94764 11.8631 6.90462 11.8294 6.87098L10.5002 5.54171V3.67956C10.5002 3.62716 10.4833 3.58414 10.4497 3.5505C10.4161 3.51686 10.373 3.50004 10.3206 3.50004H8.4585L7.12923 2.17077C7.09559 2.13713 7.05257 2.12031 7.00016 2.12031C6.94776 2.12031 6.90474 2.13713 6.8711 2.17077L5.54183 3.50004H3.67968C3.62728 3.50004 3.58426 3.51686 3.55062 3.5505C3.51698 3.58414 3.50016 3.62716 3.50016 3.67956V5.54171L2.17089 6.87098C2.13725 6.90462 2.12043 6.94764 2.12043 7.00004C2.12043 7.05244 2.13725 7.09546 2.17089 7.1291L3.50016 8.45837V10.3205C3.50016 10.3729 3.51698 10.4159 3.55062 10.4496C3.58426 10.4832 3.62728 10.5 3.67968 10.5H5.54183Z" fill="#1C1B1B" />
              </g>
            </svg>
            <span
              class="text-xs"
              [ngClass]="{
                'text-red-600': event.star_rating < 2,
                'text-orange-500': event.star_rating >= 2 && event.star_rating < 3,
                'text-green-600': event.star_rating >= 3
              }">
              {{ event.star_rating | number : '1.2-2' }}
            </span>
          </div>
        </div>
      </div>
    </ng-container>
  </app-infinity-scroll>
</ng-container>

<ng-container *ngIf="!events || events.length === 0">
  <div class="text-center py-8">
    <p class="text-sm text-gray-500">There are no events</p>
  </div>
</ng-container>
