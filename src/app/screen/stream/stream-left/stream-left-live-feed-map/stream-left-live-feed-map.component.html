<div *ngIf="liveFeed$ | async as liveFeed" class="flex flex-col gap-4 pt-3 rounded-xl bg-neutral-50 border border-neutral-500-300">
  <div class="flex flex-col px-3 gap-2">
    <div class="flex flex-row gap-1" *ngIf="liveFeed.last_updated_at">
      <svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">
        <mask id="mask0_2518_615" style="mask-type: alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="18" height="19">
          <rect y="0.5" width="18" height="18" fill="#D9D9D9" />
        </mask>
        <g mask="url(#mask0_2518_615)">
          <path d="M9.00714 15.875C8.12226 15.875 7.29332 15.7077 6.52032 15.3731C5.74745 15.0384 5.07351 14.5836 4.49851 14.0086C3.92351 13.4336 3.46876 12.7598 3.13426 11.987C2.79964 11.2141 2.63232 10.3852 2.63232 9.50037C2.63232 8.6155 2.79964 7.78656 3.13426 7.01356C3.46876 6.24044 3.92351 5.56637 4.49851 4.99137C5.07351 4.41637 5.74745 3.96156 6.52032 3.62694C7.29332 3.29231 8.12226 3.125 9.00714 3.125C9.95051 3.125 10.8467 3.32331 11.6957 3.71994C12.5447 4.11656 13.2735 4.674 13.8821 5.39225V4.17781C13.8821 4.01844 13.9361 3.88488 14.0439 3.77713C14.1518 3.66925 14.2855 3.61531 14.445 3.61531C14.6044 3.61531 14.7379 3.66925 14.8457 3.77713C14.9533 3.88488 15.0071 4.01844 15.0071 4.17781V6.74506C15.0071 6.93719 14.9422 7.09819 14.8123 7.22806C14.6823 7.35806 14.5213 7.42306 14.3293 7.42306H11.7621C11.6027 7.42306 11.4691 7.36912 11.3612 7.26125C11.2534 7.15337 11.1996 7.01975 11.1996 6.86037C11.1996 6.70087 11.2534 6.56731 11.3612 6.45969C11.4691 6.35194 11.6027 6.29806 11.7621 6.29806H13.161C12.6438 5.66056 12.0269 5.15987 11.3106 4.796C10.5942 4.432 9.82639 4.25 9.00714 4.25C7.54464 4.25 6.30401 4.75938 5.28526 5.77813C4.26651 6.79688 3.75714 8.0375 3.75714 9.5C3.75714 10.9625 4.26651 12.2031 5.28526 13.2219C6.30401 14.2406 7.54464 14.75 9.00714 14.75C10.2188 14.75 11.2969 14.3781 12.2415 13.6344C13.1863 12.8906 13.8014 11.9394 14.0871 10.7808C14.1351 10.6241 14.2199 10.5053 14.3415 10.4246C14.4631 10.3438 14.6007 10.3135 14.7542 10.3336C14.9171 10.3539 15.043 10.4265 15.132 10.5515C15.2209 10.6765 15.2451 10.8135 15.2048 10.9625C14.8808 12.3971 14.1438 13.5745 12.9938 14.4946C11.8438 15.4149 10.5149 15.875 9.00714 15.875ZM9.56964 9.27219L11.6321 11.3347C11.736 11.4384 11.7891 11.5689 11.7915 11.7262C11.794 11.8834 11.7409 12.0164 11.6321 12.125C11.5235 12.2336 11.3918 12.2879 11.2371 12.2879C11.0822 12.2879 10.9504 12.2336 10.8418 12.125L8.64807 9.93125C8.57795 9.861 8.52651 9.7845 8.49376 9.70175C8.46114 9.619 8.44482 9.5335 8.44482 9.44525V6.3125C8.44482 6.15313 8.4987 6.0195 8.60645 5.91162C8.71432 5.80387 8.84801 5.75 9.00751 5.75C9.16689 5.75 9.30045 5.80387 9.4082 5.91162C9.51582 6.0195 9.56964 6.15313 9.56964 6.3125V9.27219Z" fill="#1C1B1B" />
        </g>
      </svg>

      <p class="text-sm text-black">
        Last updated at: <span class="font-medium">{{ liveFeed.last_updated_at | dateFormat : 'serverDateTimeFormat' : 'clientDateTimeFormat' }}</span>
      </p>
    </div>
    <div *ngIf="liveFeed.location" class="flex gap-1 items-start">
      <div>
        <svg width="18" height="20" viewBox="0 0 18 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <mask id="mask0_2518_633" style="mask-type: alpha" maskUnits="userSpaceOnUse" x="0" y="2" width="18" height="18">
            <rect y="2" width="18" height="18" fill="#D9D9D9" />
          </mask>
          <g mask="url(#mask0_2518_633)">
            <path d="M8.99999 16.6351C10.4672 15.3216 11.5901 14.0618 12.3684 12.8555C13.1468 11.6493 13.536 10.5927 13.536 9.686C13.536 8.31875 13.1016 7.19475 12.2329 6.314C11.3641 5.43325 10.2865 4.99287 8.99999 4.99287C7.71349 4.99287 6.63586 5.43325 5.76711 6.314C4.89836 7.19475 4.46399 8.31875 4.46399 9.686C4.46399 10.5927 4.85318 11.6493 5.63155 12.8555C6.40993 14.0618 7.53274 15.3216 8.99999 16.6351ZM8.99999 17.7052C8.85386 17.7052 8.70774 17.68 8.56161 17.6296C8.41536 17.5791 8.28311 17.501 8.16486 17.3953C7.49186 16.775 6.86205 16.1363 6.27543 15.479C5.68893 14.8219 5.17911 14.1649 4.74599 13.5082C4.31274 12.8514 3.96993 12.2005 3.71755 11.5554C3.46518 10.9101 3.33899 10.287 3.33899 9.686C3.33899 7.95525 3.8988 6.55406 5.01843 5.48244C6.13818 4.41081 7.46536 3.875 8.99999 3.875C10.5346 3.875 11.8618 4.41081 12.9816 5.48244C14.1012 6.55406 14.661 7.95525 14.661 9.686C14.661 10.287 14.5348 10.9089 14.2824 11.5516C14.0301 12.1945 13.6885 12.8455 13.2577 13.5046C12.8269 14.1637 12.3182 14.8207 11.7317 15.4754C11.1452 16.1303 10.5154 16.7678 9.84224 17.3879C9.72574 17.4937 9.5933 17.573 9.44493 17.6259C9.29668 17.6788 9.14836 17.7052 8.99999 17.7052ZM9.0013 10.8989C9.37443 10.8989 9.69343 10.7661 9.9583 10.5003C10.2233 10.2346 10.3558 9.91512 10.3558 9.542C10.3558 9.16887 10.2229 8.84981 9.95718 8.58481C9.69143 8.31994 9.37193 8.1875 8.99868 8.1875C8.62555 8.1875 8.30655 8.32038 8.04168 8.58613C7.77668 8.85188 7.64418 9.17138 7.64418 9.54463C7.64418 9.91775 7.77705 10.2368 8.0428 10.5016C8.30855 10.7665 8.62805 10.8989 9.0013 10.8989Z" fill="#1C1B1F" />
          </g>
        </svg>
      </div>
      <p class="text-sm">
        Location: <span class="font-medium">{{ liveFeed.location }}</span>
      </p>
    </div>
    <div *ngIf="liveFeed.gps_position.length" class="flex items-center gap-1">
      <div>
        <svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">
          <mask id="mask0_2518_644" style="mask-type: alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="18" height="19">
            <rect y="0.5" width="18" height="18" fill="#D9D9D9" />
          </mask>
          <g mask="url(#mask0_2518_644)">
            <path d="M6.48319 12.4423L9.975 11.3836C10.1961 11.3135 10.3853 11.1998 10.5426 11.0426C10.6998 10.8853 10.8135 10.6961 10.8836 10.475L11.9438 6.98169C11.9803 6.85481 11.9497 6.74306 11.8523 6.64644C11.7548 6.54981 11.6429 6.52025 11.5168 6.55775L8.025 7.61637C7.80387 7.6865 7.61469 7.80019 7.45744 7.95744C7.30019 8.11469 7.1865 8.30387 7.11637 8.525L6.05625 12.0183C6.01975 12.1452 6.05025 12.2569 6.14775 12.3536C6.24525 12.4502 6.35706 12.4798 6.48319 12.4423ZM8.99831 10.4808C8.72544 10.4808 8.49406 10.3853 8.30419 10.1941C8.11419 10.0031 8.01919 9.77119 8.01919 9.49831C8.01919 9.22544 8.11475 8.99406 8.30587 8.80419C8.49688 8.61419 8.72881 8.51919 9.00169 8.51919C9.27456 8.51919 9.50594 8.61475 9.69581 8.80587C9.88581 8.99688 9.98081 9.22881 9.98081 9.50169C9.98081 9.77456 9.88525 10.0059 9.69413 10.1958C9.50313 10.3858 9.27119 10.4808 8.99831 10.4808ZM9.00131 16.625C8.01581 16.625 7.0895 16.438 6.22237 16.064C5.35525 15.69 4.601 15.1824 3.95962 14.5413C3.31825 13.9002 2.81044 13.1463 2.43619 12.2795C2.06206 11.4128 1.875 10.4867 1.875 9.50131C1.875 8.51581 2.062 7.5895 2.436 6.72237C2.81 5.85525 3.31756 5.101 3.95869 4.45962C4.59981 3.81825 5.35375 3.31044 6.2205 2.93619C7.08725 2.56206 8.01331 2.375 8.99869 2.375C9.98419 2.375 10.9105 2.562 11.7776 2.936C12.6448 3.31 13.399 3.81756 14.0404 4.45869C14.6818 5.09981 15.1896 5.85375 15.5638 6.7205C15.9379 7.58725 16.125 8.51331 16.125 9.49869C16.125 10.4842 15.938 11.4105 15.564 12.2776C15.19 13.1448 14.6824 13.899 14.0413 14.5404C13.4002 15.1818 12.6463 15.6896 11.7795 16.0638C10.9128 16.4379 9.98669 16.625 9.00131 16.625ZM9 15.5C10.6672 15.5 12.0841 14.9168 13.2504 13.7504C14.4168 12.5841 15 11.1672 15 9.5C15 7.83275 14.4168 6.41594 13.2504 5.24956C12.0841 4.08319 10.6672 3.5 9 3.5C7.33275 3.5 5.91594 4.08319 4.74956 5.24956C3.58319 6.41594 3 7.83275 3 9.5C3 11.1672 3.58319 12.5841 4.74956 13.7504C5.91594 14.9168 7.33275 15.5 9 15.5Z" fill="#1C1B1F" />
          </g>
        </svg>
      </div>
      <p class="text-sm">
        Map position: <span class="font-medium">{{ liveFeed.gps_position[0] }}, {{ liveFeed.gps_position[1] }}</span>
      </p>
      <p class="text-xs text-neutral-600">(Longitude, Latitude)</p>
    </div>
  </div>
  <app-map class="h-[350px]" [center]="liveFeed.gps_position" [playbackMarkers]="markers$ | async" [zoom]="15" [rounded]="false" [isClusterer]="false"></app-map>
</div>
