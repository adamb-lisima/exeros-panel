<ng-container *ngIf="liveFeed$ | async as liveFeed">
  <div *ngIf="alarms$ | async as alarms" class="h-[600px] p-5 rounded-xl bg-white">
    <app-infinity-scroll *ngIf="alarmsMeta$ | async as meta" [transparent]="true" [listGap]="true" [pageMeta]="meta" [loading]="alarmsLoading$ | async" (nextPageRequest)="handleNextPageRequest($event)">
      <ng-container filters>
        <p class="font-medium text-sm text-neutral-500">Vehicle's recent updates</p>
      </ng-container>
      <ng-container list>
        <ng-container *ngIf="alarms.length; else noAlarmsTemplate">
          <div *ngFor="let alarm of webSocketAlarms$ | async | filter : liveFeed.device_id : 'deviceno'; trackByField: 'alarmId'" class="flex gap-2">
            <div>
              <svg width="19" height="20" viewBox="0 0 19 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M11.3008 19.8236C6.33005 20.8047 1.36047 17.599 0.252621 12.683C-0.287331 10.2905 0.0444871 8.01392 1.26057 5.87089C1.48 5.48437 1.84512 5.31297 2.26792 5.37917C2.4514 5.41234 2.62103 5.49836 2.75573 5.62656C2.89042 5.75475 2.98423 5.91946 3.02552 6.10021C3.08498 6.35848 3.02909 6.59548 2.90005 6.82184C2.14424 8.15517 1.81242 9.58484 1.93194 11.1126C2.09012 13.1315 2.928 14.8301 4.44379 16.1753C6.09457 17.641 8.04802 18.2556 10.2518 18.0707C13.5974 17.7893 16.4298 15.1634 16.9911 11.8319C17.3156 9.96258 16.9195 8.04041 15.8818 6.44836C14.8441 4.85632 13.2409 3.7113 11.3918 3.24146C10.0777 2.90177 8.69551 2.9222 7.39212 3.30056C7.33682 3.31652 7.2833 3.33721 7.19707 3.36676C7.34038 3.42586 7.45694 3.46959 7.57052 3.52101C7.79147 3.61475 7.96803 3.78885 8.06409 4.00769C8.16015 4.22654 8.16844 4.47359 8.08727 4.69832C7.91601 5.17586 7.40936 5.45305 6.92292 5.28224C6.03609 4.97137 5.15639 4.64099 4.28383 4.29111C4.06753 4.20249 3.89441 4.03373 3.80107 3.82051C3.70774 3.6073 3.7015 3.36636 3.78371 3.14867C4.09888 2.28185 4.42674 1.42133 4.76728 0.567113C4.95876 0.0895712 5.49574 -0.116693 5.97147 0.0659308C6.19945 0.151961 6.38492 0.322619 6.48876 0.541921C6.5926 0.761223 6.60669 1.01203 6.52808 1.24146C6.49061 1.35967 6.44661 1.47787 6.39904 1.61203C6.7713 1.51688 7.12452 1.41699 7.48191 1.33602C12.505 0.201864 17.6244 3.42645 18.7626 8.44004C19.0476 9.67583 19.0793 10.956 18.8558 12.2042C18.6324 13.4524 18.1584 14.6431 17.4621 15.7054C16.7658 16.7677 15.8614 17.6798 14.8029 18.3873C13.7443 19.0948 12.5533 19.5833 11.3008 19.8236Z" fill="currentColor" />
                <path d="M12.3101 13.1815C12.163 13.2506 12.0029 13.2878 11.8403 13.2909C10.601 13.2991 9.36195 13.3003 8.12307 13.2944C7.52841 13.2944 7.13474 12.899 7.13296 12.305C7.12939 10.8228 7.12939 9.34069 7.13296 7.85882C7.13296 7.28258 7.53495 6.87714 8.08441 6.87891C8.63388 6.88069 9.02279 7.2873 9.02517 7.86709C9.02933 8.95811 9.02517 10.0491 9.02517 11.1407V11.402H9.2892C10.1425 11.402 10.9959 11.3984 11.8462 11.402C12.322 11.4049 12.6966 11.6975 12.7977 12.1212C12.8988 12.545 12.7073 12.9942 12.3101 13.1815Z" fill="currentColor" />
              </svg>
            </div>
            <div class="flex flex-col gap-2">
              <p class="font-medium text-sm">{{ alarm.type }}</p>
              <p class="text-xs opacity-60">{{ alarm.content }}</p>
              <p class="text-xs opacity-60">{{ alarm.dateTime | dateFormat : 'serverDateTimeFormat' : 'clientDateTimeFormat' }}</p>
            </div>
          </div>
          <div *ngFor="let alarm of alarms; trackByField: 'id'" class="flex gap-2">
            <div>
              <svg width="19" height="20" viewBox="0 0 19 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M11.3008 19.8236C6.33005 20.8047 1.36047 17.599 0.252621 12.683C-0.287331 10.2905 0.0444871 8.01392 1.26057 5.87089C1.48 5.48437 1.84512 5.31297 2.26792 5.37917C2.4514 5.41234 2.62103 5.49836 2.75573 5.62656C2.89042 5.75475 2.98423 5.91946 3.02552 6.10021C3.08498 6.35848 3.02909 6.59548 2.90005 6.82184C2.14424 8.15517 1.81242 9.58484 1.93194 11.1126C2.09012 13.1315 2.928 14.8301 4.44379 16.1753C6.09457 17.641 8.04802 18.2556 10.2518 18.0707C13.5974 17.7893 16.4298 15.1634 16.9911 11.8319C17.3156 9.96258 16.9195 8.04041 15.8818 6.44836C14.8441 4.85632 13.2409 3.7113 11.3918 3.24146C10.0777 2.90177 8.69551 2.9222 7.39212 3.30056C7.33682 3.31652 7.2833 3.33721 7.19707 3.36676C7.34038 3.42586 7.45694 3.46959 7.57052 3.52101C7.79147 3.61475 7.96803 3.78885 8.06409 4.00769C8.16015 4.22654 8.16844 4.47359 8.08727 4.69832C7.91601 5.17586 7.40936 5.45305 6.92292 5.28224C6.03609 4.97137 5.15639 4.64099 4.28383 4.29111C4.06753 4.20249 3.89441 4.03373 3.80107 3.82051C3.70774 3.6073 3.7015 3.36636 3.78371 3.14867C4.09888 2.28185 4.42674 1.42133 4.76728 0.567113C4.95876 0.0895712 5.49574 -0.116693 5.97147 0.0659308C6.19945 0.151961 6.38492 0.322619 6.48876 0.541921C6.5926 0.761223 6.60669 1.01203 6.52808 1.24146C6.49061 1.35967 6.44661 1.47787 6.39904 1.61203C6.7713 1.51688 7.12452 1.41699 7.48191 1.33602C12.505 0.201864 17.6244 3.42645 18.7626 8.44004C19.0476 9.67583 19.0793 10.956 18.8558 12.2042C18.6324 13.4524 18.1584 14.6431 17.4621 15.7054C16.7658 16.7677 15.8614 17.6798 14.8029 18.3873C13.7443 19.0948 12.5533 19.5833 11.3008 19.8236Z" fill="currentColor" />
                <path d="M12.3101 13.1815C12.163 13.2506 12.0029 13.2878 11.8403 13.2909C10.601 13.2991 9.36195 13.3003 8.12307 13.2944C7.52841 13.2944 7.13474 12.899 7.13296 12.305C7.12939 10.8228 7.12939 9.34069 7.13296 7.85882C7.13296 7.28258 7.53495 6.87714 8.08441 6.87891C8.63388 6.88069 9.02279 7.2873 9.02517 7.86709C9.02933 8.95811 9.02517 10.0491 9.02517 11.1407V11.402H9.2892C10.1425 11.402 10.9959 11.3984 11.8462 11.402C12.322 11.4049 12.6966 11.6975 12.7977 12.1212C12.8988 12.545 12.7073 12.9942 12.3101 13.1815Z" fill="currentColor" />
              </svg>
            </div>
            <div class="flex flex-col gap-2">
              <p class="font-medium text-sm">{{ alarm.type }}</p>
              <p class="text-xs opacity-60">{{ alarm.content }}</p>
              <p class="text-xs opacity-60">{{ alarm.time | dateFormat : 'serverDateTimeFormat' : 'clientDateTimeFormat' }}</p>
            </div>
          </div>
        </ng-container>
        <ng-template #noAlarmsTemplate>
          <p class="text-sm">There are no updates available</p>
        </ng-template>
      </ng-container>
    </app-infinity-scroll>
  </div>
</ng-container>
