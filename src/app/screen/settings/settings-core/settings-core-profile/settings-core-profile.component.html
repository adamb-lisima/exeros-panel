<ng-container *ngIf="loggedInUser$ | async as loggedInUser">
  <div *appHasPermission="[[accessGroup.SETTINGS_PROFILE]]" class="flex flex-col gap-8">

    <!-- Profile Card -->
    <div class="settings-card">
      <div class="settings-card__header">
        <span class="settings-card__title">Profile information</span>
        <app-button (buttonClick)="handleEditClick()">
          <span class="text-sm text-white font-semibold">Edit profile</span>
        </app-button>
      </div>
      <div class="settings-card__body">
        <div class="flex gap-10 items-start">
          <!-- Avatar -->
          <div class="settings-avatar" *ngIf="loggedInUser.avatar as avatar">
            <img class="settings-avatar__img" [ngSrc]="avatar" width="120" height="120" alt="avatar" />
          </div>
          <!-- Info Grid -->
          <div class="settings-info-grid">
            <div class="settings-info-row">
              <span class="settings-info-row__label">Name</span>
              <span class="settings-info-row__value">{{ loggedInUser.name }}</span>
            </div>
            <div class="settings-info-row">
              <span class="settings-info-row__label">Role</span>
              <span class="settings-info-row__value">{{ loggedInUser.role }}</span>
            </div>
            <div class="settings-info-row">
              <span class="settings-info-row__label">E-mail</span>
              <span class="settings-info-row__value">{{ loggedInUser.email }}</span>
            </div>
            <div class="settings-info-row">
              <span class="settings-info-row__label">Password</span>
              <div class="flex items-center gap-3">
                <span class="settings-info-row__value">••••••••••••</span>
                <span class="settings-link" (click)="handleChangePasswordClick()" (keydown.enter)="handleChangePasswordClick()">Change</span>
              </div>
            </div>
            <div class="settings-info-row">
              <span class="settings-info-row__label">MFA enabled</span>
              <div class="flex items-center gap-3">
                <span class="settings-info-row__value" [class.text-green-600]="loggedInUser.is_mfa_enabled" [class.text-red-500]="!loggedInUser.is_mfa_enabled">{{ loggedInUser.is_mfa_enabled ? 'Yes' : 'No' }}</span>
                <span *ngIf="!loggedInUser.is_mfa_enabled || loggedInUser.can_mfa_be_disabled" class="settings-link" (click)="handleMFAClick(loggedInUser.is_mfa_enabled)" (keydown.enter)="handleMFAClick(loggedInUser.is_mfa_enabled)">{{ loggedInUser.is_mfa_enabled ? 'Disable' : 'Enable' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Email Notifications Card -->
    <div class="settings-card">
      <div class="settings-card__header">
        <span class="settings-card__title">Email notifications</span>
      </div>
      <div class="settings-card__body">
        <span class="text-sm text-neutral-500 mb-4 block">Receiving email notifications for:</span>
        <div *ngIf="notifications$ | async as notifications" class="flex flex-col gap-3">
          <div *ngFor="let notification of notifications" class="flex items-center gap-3 py-2 px-3 rounded-lg bg-neutral-50">
            <img [ngSrc]="notification.src" width="22" height="22" [alt]="notification.name" />
            <p class="text-sm font-medium text-neutral-700">{{ notification.name }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Application Settings Card -->
    <div class="settings-card">
      <div class="settings-card__header">
        <span class="settings-card__title">Application settings</span>
      </div>
      <div class="settings-card__body">
        <div class="flex items-center gap-4">
          <span class="text-sm text-neutral-600">Application view</span>
          <app-select-control [showHintSpace]="false" [options]="themes" [formControl]="themeControl"></app-select-control>
        </div>
      </div>
    </div>

  </div>
</ng-container>
